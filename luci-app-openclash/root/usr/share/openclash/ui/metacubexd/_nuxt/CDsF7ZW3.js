import{$ as e,C as t,Et as n,G as r,H as i,J as a,N as o,Ot as s,P as c,Q as l,V as u,W as d,X as f,Z as p,_t as m,at as h,ct as g,ft as _,j as v,kt as y,pt as b,q as x,st as S,x as C,yt as w,z as T}from"./CM_088kD.js";import{s as E}from"./_v7-ePgP.js";import{C as ee,S as te,i as ne,u as D}from"./BJ759pwc.js";import{t as O}from"./BLNk-Hhf.js";import{n as k}from"./rrywKo0Q.js";import{p as A}from"./Dd7-kRkh.js";import{t as j}from"./DzC77LRm.js";var M=[];for(let e=0;e<256;++e)M.push((e+256).toString(16).slice(1));function N(e,t=0){return(M[e[t+0]]+M[e[t+1]]+M[e[t+2]]+M[e[t+3]]+`-`+M[e[t+4]]+M[e[t+5]]+`-`+M[e[t+6]]+M[e[t+7]]+`-`+M[e[t+8]]+M[e[t+9]]+`-`+M[e[t+10]]+M[e[t+11]]+M[e[t+12]]+M[e[t+13]]+M[e[t+14]]+M[e[t+15]]).toLowerCase()}var P,F=new Uint8Array(16);function I(){if(!P){if(typeof crypto>`u`||!crypto.getRandomValues)throw Error(`crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported`);P=crypto.getRandomValues.bind(crypto)}return P(F)}var L={randomUUID:typeof crypto<`u`&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function R(e,t,n){e||={};let r=e.random??e.rng?.()??I();if(r.length<16)throw Error(`Random bytes length must be >= 16`);if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){if(n||=0,n<0||n+16>t.length)throw RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=r[e];return t}return N(r)}function z(e,t,n){return L.randomUUID&&!t&&!e?L.randomUUID():R(e,t,n)}var B=z,V={class:`flex h-full items-center justify-center overflow-y-auto bg-gradient-to-b from-base-100 to-base-200 p-4`},H={class:`animate-fade-slide-in mx-auto w-full max-w-md`},re={class:`animate-fade-slide-in-delay-1 mb-8 text-center`},U={class:`mb-4`},W={class:`shadow-primary-glow mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-br from-primary to-secondary text-primary-content`},G={class:`text-[0.9375rem] text-base-content/60`},K={class:`shadow-card animate-fade-slide-in-delay-2 rounded-2xl border border-base-content/8 bg-base-200/80 p-6 backdrop-blur-md`},q={class:`flex flex-col gap-2`},J={class:`flex items-center gap-2 text-sm font-medium text-base-content/70`,for:`url`},Y={id:`defaultEndpoints`},X=[`value`],ie=[`value`],ae=[`value`],oe=[`value`],se={class:`flex flex-col gap-2`},ce={class:`flex items-center gap-2 text-sm font-medium text-base-content/70`,for:`secret`},le={key:0,class:`animate-fade-slide-in-delay-3 mt-6`},ue={class:`grid grid-cols-2 gap-3`},de=[`onClick`],Z={class:`flex h-7 w-7 shrink-0 items-center justify-center rounded-md bg-info/20 text-info`},fe={class:`min-w-0 flex-1 overflow-hidden text-[0.8125rem] font-medium text-ellipsis whitespace-nowrap text-base-content`},pe=[`onClick`],Q=O(e({__name:`setup`,setup(e){let{t:O}=C();v({title:d(()=>O(`setup`))});let M=c(),N=o(),P=t(),F=m({url:``,secret:``}),I=w(!1),L=d(()=>typeof window>`u`?``:window.__METACUBEXD_CONFIG__?.defaultBackendURL||`http://127.0.0.1:9090`),R=d(()=>typeof window>`u`?``:window.location.origin);function z(e){P.setSelectedEndpoint(e),M.replace(`/overview`)}async function Q(e){let t=P.endpointList.find(t=>t.id===e);t&&await k(t.url,t.secret)&&z(e)}async function $(){I.value=!0;try{let e=F.url,t=F.secret,n=A(e);if(!await k(n,t)){I.value=!1;return}let r=B(),i=[...P.endpointList],a=i.find(e=>e.url===n);if(!a){P.setEndpointList([{id:r,url:n,secret:t},...i]),z(r);return}a.secret=t,a.id=r,P.setEndpointList(i),z(r)}finally{I.value=!1}}function me(e){P.removeEndpoint(e)}return h(async()=>{let e=N.query||(typeof window<`u`?new URLSearchParams(window.location.search):null);if(e&&typeof e==`object`){let t=e.hostname;if(t){F.url=`${e.http?`http:`:e.https?`https:`:typeof window<`u`?window.location.protocol:`http:`}//${t}${e.port?`:${e.port}`:``}`,F.secret=e.secret||``,await $();return}}P.endpointList.length===0&&(F.url=L.value,F.secret=``,await $())}),(e,t)=>{let o=j;return S(),a(`div`,V,[r(`div`,H,[r(`div`,re,[r(`div`,U,[r(`div`,W,[l(n(D),{size:32})]),t[2]||=f(`<h1 class="text-3xl font-bold tracking-wide uppercase sm:text-4xl" data-v-b062798a><span class="bg-gradient-to-br from-primary to-secondary bg-clip-text text-transparent" data-v-b062798a>metacube</span><span class="text-base-content" data-v-b062798a>(</span><a class="inline-block text-primary no-underline transition-all duration-300 hover:scale-110 hover:rotate-5" href="https://github.com/metacubex/metacubexd" target="_blank" data-v-b062798a> xd </a><span class="text-base-content" data-v-b062798a>)</span></h1>`,1)]),r(`p`,G,y(n(O)(`setupDescription`)),1)]),r(`div`,K,[r(`form`,{class:`flex flex-col gap-5`,onSubmit:u($,[`prevent`])},[r(`div`,q,[r(`label`,J,[l(n(ee),{size:16}),r(`span`,null,y(n(O)(`endpointURL`)),1)]),b(r(`input`,{id:`url`,"onUpdate:modelValue":t[0]||=e=>n(F).url=e,type:`url`,class:`w-full rounded-lg border border-base-content/15 bg-base-100/80 px-4 py-3 text-[0.9375rem] text-base-content transition-all duration-200 placeholder:text-base-content/40 focus:border-primary focus:ring-3 focus:ring-primary/20 focus:outline-none`,placeholder:`http(s)://{hostname}:{port}`,list:`defaultEndpoints`,autocomplete:`on`},null,512),[[T,n(F).url]]),r(`datalist`,Y,[r(`option`,{value:n(E)},null,8,X),n(L)&&n(L)!==n(`http://127.0.0.1:9090`)?(S(),a(`option`,{key:0,value:n(L)},null,8,ie)):x(``,!0),n(R)&&n(R)!==n(`http://127.0.0.1:9090`)?(S(),a(`option`,{key:1,value:n(R)},null,8,ae)):x(``,!0),(S(!0),a(i,null,g(n(P).endpointList,e=>(S(),a(`option`,{key:e.id,value:e.url},null,8,oe))),128))])]),t[3]||=r(`input`,{type:`text`,name:`username`,autocomplete:`username`,class:`sr-only`,"aria-hidden":`true`,tabindex:`-1`},null,-1),r(`div`,se,[r(`label`,ce,[l(n(te),{size:16}),r(`span`,null,y(n(O)(`secret`)),1)]),b(r(`input`,{id:`secret`,"onUpdate:modelValue":t[1]||=e=>n(F).secret=e,type:`password`,class:`w-full rounded-lg border border-base-content/15 bg-base-100/80 px-4 py-3 text-[0.9375rem] text-base-content transition-all duration-200 placeholder:text-base-content/40 focus:border-primary focus:ring-3 focus:ring-primary/20 focus:outline-none`,placeholder:`secret`,autocomplete:`current-password`},null,512),[[T,n(F).secret]])]),l(o,{type:`submit`,class:`hover:shadow-primary-glow-lg w-full cursor-pointer rounded-lg border-none bg-gradient-to-br from-primary to-secondary px-6 py-3.5 text-[0.9375rem] font-semibold tracking-widest text-primary-content uppercase transition-all duration-300 hover:-translate-y-0.5`,loading:n(I)},{default:_(()=>[p(y(n(O)(`add`)),1)]),_:1},8,[`loading`])],32)]),n(P).endpointList.length>0?(S(),a(`div`,le,[t[4]||=r(`h3`,{class:`mb-3 text-[0.8125rem] font-semibold tracking-widest text-base-content/50 uppercase`},` Saved Endpoints `,-1),r(`div`,ue,[(S(!0),a(i,null,g(n(P).endpointList,(e,t)=>(S(),a(`div`,{key:e.id,class:`animate-fade-slide-in flex cursor-pointer items-center gap-2 rounded-xl border border-info/20 bg-info/10 p-3 transition-all duration-200 hover:-translate-y-0.5 hover:border-info/30 hover:bg-info/15`,style:s({animationDelay:`${t*50}ms`}),onClick:t=>Q(e.id)},[r(`div`,Z,[l(n(D),{size:16})]),r(`span`,fe,y(e.url),1),r(`button`,{class:`flex h-6 w-6 shrink-0 cursor-pointer items-center justify-center rounded-full border-none bg-transparent text-base-content/50 transition-all duration-200 hover:bg-error/15 hover:text-error`,onClick:u(t=>me(e.id),[`stop`])},[l(n(ne),{size:14})],8,pe)],12,de))),128))])])):x(``,!0)])])}}}),[[`__scopeId`,`data-v-b062798a`]]);export{Q as default};