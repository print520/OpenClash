import{$ as e,Dt as t,E as n,Et as r,G as i,H as a,J as o,K as s,Q as c,R as l,V as ee,W as u,Z as d,ct as f,et as p,ft as m,ht as te,j as h,kt as g,pt as _,q as v,st as y,ut as ne,x as re,yt as b,z as ie}from"./C4vawhhX.js";import{u as x}from"./_v7-ePgP.js";import{t as ae}from"./CzmD_A01.js";import{D as oe,c as se,g as ce,h as le,l as ue,n as S,t as C,u as de}from"./CEatu4QW.js";import{t as fe}from"./D9h1X1e8.js";import{t as pe}from"./BY6HYtMz.js";import{t as me}from"./BaIHsnkQ.js";import{t as he}from"./7Wr_k_ga.js";var ge={class:`flex h-full min-h-0 flex-col gap-2`},w={class:`join w-full shrink-0`},T=[`placeholder`],E={class:`min-h-0 flex-1 overflow-auto rounded-md bg-base-300 whitespace-nowrap`},D={class:`bg-base-200`},O={class:`flex items-center gap-2`},k=[`onClick`],A=[`onClick`],j=[`onClick`],M=[`colspan`],N={class:`flex items-center gap-2`},P={class:`font-semibold text-primary`},F={class:`text-xs text-base-content/60`},I={key:1,class:`hover`},L={key:0,class:`py-8 text-center text-base-content/70`},_e={class:`flex flex-col gap-4`},ve={value:`xs`},ye={value:`sm`},be={value:`md`},R={value:`lg`},xe={value:`info`},Se={value:`error`},Ce={value:`warning`},we={value:`debug`},Te={value:`silent`},z=e({__name:`logs`,setup(e){let{t:z}=re();h({title:u(()=>z(`logs`))});let B=fe(),V=ae(),H=b(``),U=b();function W(e){return e.match(/^\[([^\]]+)\]/)?.[1]??``}function Ee(e){switch(e){case x.Error:return`text-error`;case x.Warning:return`text-warning`;case x.Info:return`text-info`;case x.Debug:return`text-success`;default:return``}}let G=[{id:`seq`,label:z(`sequence`),sortable:!0,groupable:!1,render:e=>String(e.seq),sortValue:e=>e.seq},{id:`level`,label:z(`level`),sortable:!0,groupable:!0,render:e=>p(`span`,{class:Ee(e.type)},`[${e.type}]`),sortValue:e=>e.type,groupValue:e=>e.type},{id:`type`,label:z(`type`),sortable:!0,groupable:!0,render:e=>p(`span`,{class:`opacity-70`},W(e.payload)),sortValue:e=>W(e.payload),groupValue:e=>W(e.payload)||`(empty)`},{id:`payload`,label:z(`payload`),sortable:!1,groupable:!1,render:e=>e.payload}],K=n(`logsTableSortColumn`,`seq`),q=n(`logsTableSortDesc`,!0),J=n(`logsTableGrouping`,null),Y=b({}),X=u(()=>{if(!H.value)return B.logs;let e=H.value.toLowerCase();return B.logs.filter(t=>t.payload.toLowerCase().includes(e)||t.type.toLowerCase().includes(e)||W(t.payload).toLowerCase().includes(e))}),Z=u(()=>{let e=G.find(e=>e.id===K.value);return e?.sortValue?[...X.value].sort((t,n)=>{let r=e.sortValue(t),i=e.sortValue(n),a=0;return typeof r==`number`&&typeof i==`number`?a=r-i:typeof r==`string`&&typeof i==`string`&&(a=r.localeCompare(i)),q.value?-a:a}):X.value}),De=u(()=>J.value?G.find(e=>e.id===J.value):null),Q=u(()=>{let e=De.value;if(!e?.groupValue)return Z.value.map(e=>({type:`data`,original:e}));let t=new Map;for(let n of Z.value){let r=e.groupValue(n),i=t.get(r);i?i.push(n):t.set(r,[n])}let n=[];for(let[e,r]of t)if(n.push({type:`group`,key:e,subRows:r}),Y.value[e])for(let e of r)n.push({type:`data`,original:e});return n});function Oe(e){return G.find(t=>t.id===e)?.sortable??!1}function $(e){return K.value===e}function ke(e){G.find(t=>t.id===e)?.sortable&&(K.value===e?q.value?q.value=!1:(K.value=``,q.value=!0):(K.value=e,q.value=!0))}function Ae(e){J.value===e?J.value=null:J.value=e,Y.value={}}function je(e){Y.value[e]=!Y.value[e]}let Me=u(()=>V.tableSizeClassName(V.logsTableSize));return(e,n)=>{let u=me,p=pe,h=he;return y(),o(`div`,ge,[i(`div`,w,[_(i(`input`,{"onUpdate:modelValue":n[0]||=e=>te(H)?H.value=e:null,type:`search`,class:`input input-sm join-item flex-1 shrink-0 input-primary`,placeholder:r(z)(`search`)},null,8,T),[[ie,r(H)]]),c(u,{class:`btn join-item btn-sm btn-primary`,onClick:n[1]||=e=>r(B).togglePaused()},{default:m(()=>[r(B).paused?(y(),s(r(le),{key:1})):(y(),s(r(ce),{key:0}))]),_:1}),c(u,{class:`btn join-item btn-sm btn-primary`,onClick:n[2]||=e=>r(U)?.open()},{default:m(()=>[c(r(de))]),_:1})]),i(`div`,E,[i(`table`,{class:t([`table-pin-rows table table-zebra`,r(Me)])},[i(`thead`,null,[i(`tr`,D,[(y(),o(a,null,f(G,e=>i(`th`,{key:e.id,class:`text-base-content`},[i(`div`,O,[i(`div`,{class:t([`flex-1`,{"cursor-pointer select-none":Oe(e.id)}]),onClick:t=>ke(e.id)},g(e.label),11,k),$(e.id)&&!r(q)?(y(),s(r(ue),{key:0,size:16})):$(e.id)&&r(q)?(y(),s(r(se),{key:1,size:16})):v(``,!0),e.groupable?(y(),o(`button`,{key:2,class:`cursor-pointer`,onClick:ee(t=>Ae(e.id),[`stop`])},[r(J)===e.id?(y(),s(r(C),{key:0,size:18})):(y(),s(r(S),{key:1,size:18}))],8,A)):v(``,!0)])])),64))])]),i(`tbody`,null,[(y(!0),o(a,null,f(r(Q),e=>(y(),o(a,{key:e.type===`group`?`group-${e.key}`:e.original.seq},[e.type===`group`?(y(),o(`tr`,{key:0,class:`cursor-pointer bg-base-200 hover:bg-base-300`,onClick:t=>je(e.key)},[i(`td`,{colspan:G.length,class:`py-2`},[i(`div`,N,[r(Y)[e.key]?(y(),s(r(C),{key:0,size:18})):(y(),s(r(S),{key:1,size:18})),i(`span`,P,g(e.key),1),i(`span`,F,`(`+g(e.subRows.length)+`)`,1)])],8,M)],8,j)):(y(),o(`tr`,I,[(y(),o(a,null,f(G,t=>i(`td`,{key:t.id,class:`whitespace-nowrap`},[(y(),s(ne(()=>t.render(e.original))))])),64))]))],64))),128))])],2),r(Q).length===0?(y(),o(`div`,L,g(r(z)(`noData`)),1)):v(``,!0)]),c(h,{ref_key:`settingsModal`,ref:U,title:r(z)(`logsSettings`)},{icon:m(()=>[c(r(oe),{size:24})]),default:m(()=>[i(`div`,_e,[i(`div`,null,[c(p,{"with-divider":``},{default:m(()=>[d(g(r(z)(`tableSize`)),1)]),_:1}),_(i(`select`,{"onUpdate:modelValue":n[3]||=e=>r(V).logsTableSize=e,class:`select w-full`},[i(`option`,ve,g(r(z)(`xs`)),1),i(`option`,ye,g(r(z)(`sm`)),1),i(`option`,be,g(r(z)(`md`)),1),i(`option`,R,g(r(z)(`lg`)),1)],512),[[l,r(V).logsTableSize]])]),i(`div`,null,[c(p,{"with-divider":``},{default:m(()=>[d(g(r(z)(`logLevel`)),1)]),_:1}),_(i(`select`,{"onUpdate:modelValue":n[4]||=e=>r(V).logLevel=e,class:`select w-full`},[i(`option`,xe,g(r(z)(`info`)),1),i(`option`,Se,g(r(z)(`error`)),1),i(`option`,Ce,g(r(z)(`warning`)),1),i(`option`,we,g(r(z)(`debug`)),1),i(`option`,Te,g(r(z)(`silent`)),1)],512),[[l,r(V).logLevel]])]),i(`div`,null,[c(p,{"with-divider":``},{default:m(()=>[d(g(r(z)(`logMaxRows`)),1)]),_:1}),_(i(`select`,{"onUpdate:modelValue":n[5]||=e=>r(V).logMaxRows=e,class:`select w-full`},[...n[6]||=[i(`option`,{value:200},`200`,-1),i(`option`,{value:300},`300`,-1),i(`option`,{value:500},`500`,-1),i(`option`,{value:800},`800`,-1),i(`option`,{value:1e3},`1000`,-1)]],512),[[l,r(V).logMaxRows]])])])]),_:1},8,[`title`])])}}});export{z as default};