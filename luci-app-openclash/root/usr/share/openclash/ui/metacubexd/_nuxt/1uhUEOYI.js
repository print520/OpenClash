import"./DhuzWLOQ.js";import{$ as e,B as t,C as n,D as r,Dt as i,E as a,Et as o,G as s,H as c,I as l,J as u,K as d,Mt as f,N as p,Ot as m,Q as h,S as g,U as _,V as v,W as y,at as b,ct as x,dt as S,ft as C,it as w,kt as T,lt as E,ot as D,pt as O,q as k,rt as A,st as j,ut as M,x as N,yt as P}from"./CM_088kD.js";import"./_v7-ePgP.js";import{t as F}from"./Cdiy0J91.js";import{t as I}from"./BLuqy5mK.js";import{a as L,i as ee,n as R,o as z,r as B}from"./CPIE5wZ-.js";import{E as te,I as V,K as H,L as U,O as ne,U as W,b as G,f as K,i as re,j as q,k as ie,l as ae,w as J,x as Y,y as X}from"./BJ759pwc.js";import{n as Z,t as Q}from"./BjfpQpZD.js";import{t as $}from"./BLNk-Hhf.js";import{g as oe,v as se}from"./rrywKo0Q.js";import{n as ce,t as le}from"./BZwboPFT.js";import{t as ue}from"./D9Xz31Em.js";import{t as de}from"./DV8N7_8X.js";import{l as fe}from"./Dd7-kRkh.js";var pe={class:`flex min-w-0 items-center gap-1 text-sm font-bold whitespace-nowrap uppercase sm:text-xl`},me=e({__name:`LogoText`,setup(e){let t=n(),r=y(()=>!!t.currentEndpoint);return(e,t)=>{let n=g;return j(),u(`div`,pe,[h(n,{class:`bg-gradient-to-br from-primary to-secondary bg-clip-text text-transparent no-underline`,to:o(r)?`/`:`/setup`},{default:C(()=>[...t[0]||=[s(`span`,{class:`hidden min-[400px]:inline`},`metacube`,-1),s(`span`,{class:`inline min-[400px]:hidden`},`mcx`,-1)]]),_:1},8,[`to`]),t[1]||=s(`span`,{class:`text-base-content`},`(`,-1),t[2]||=s(`a`,{class:`inline-block text-primary no-underline transition-transform duration-300 ease-in-out hover:scale-125 hover:rotate-90`,href:`https://github.com/metacubex/metacubexd`,target:`_blank`},` xd `,-1),t[3]||=s(`span`,{class:`text-base-content`},`)`,-1)])}}}),he=Object.assign(me,{__name:`LogoText`}),ge={class:`relative`},_e={class:`m-0 list-none p-1.5`},ve=[`onClick`],ye={key:0,class:`flex h-4 w-4 items-center justify-center text-primary`},be=e({__name:`LangSwitcher`,setup(e){let{locale:t,locales:n,setLocale:r}=N(),a=y(()=>n.value.map(e=>typeof e==`string`?{code:e,name:e}:e)),f=P(null),p=P(null),g=P(!1),{floatingStyles:S}=R(f,p,{placement:`top`,middleware:[L(10),ee(),z({padding:8})],whileElementsMounted:B});function w(){g.value=!g.value}function E(e){r(e),g.value=!1}function O(e){let t=e.target;!f.value?.contains(t)&&!p.value?.contains(t)&&(g.value=!1)}return b(()=>{document.addEventListener(`click`,O)}),D(()=>{document.removeEventListener(`click`,O)}),(e,n)=>(j(),u(`div`,ge,[s(`button`,{ref_key:`reference`,ref:f,class:i([`flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border-none bg-transparent text-base-content/70 transition-all duration-200 ease-in-out hover:bg-base-content/10 hover:text-base-content`,{"bg-primary/15 text-primary":o(g)}]),"aria-label":`Change language`,onClick:v(w,[`stop`])},[h(o(J),{size:18})],2),(j(),d(_,{to:`body`},[h(l,{"enter-active-class":`transition-opacity duration-150`,"leave-active-class":`transition-opacity duration-100`,"enter-from-class":`opacity-0`,"leave-to-class":`opacity-0`},{default:C(()=>[o(g)?(j(),u(`div`,{key:0,ref_key:`floating`,ref:p,style:m(o(S)),class:`z-70 w-40 overflow-hidden rounded-xl border border-base-content/10 bg-base-300/98 shadow-[0_10px_40px_var(--color-base-content)/20,0_0_0_1px_var(--color-base-content)/5] backdrop-blur-[12px]`},[n[1]||=s(`div`,{class:`flex items-center border-b border-base-content/8 bg-base-200/60 px-3 py-2.5`},[s(`span`,{class:`text-[0.6875rem] font-semibold tracking-[0.05em] text-base-content/50 uppercase`},`Language`)],-1),s(`ul`,_e,[(j(!0),u(c,null,x(o(a),e=>(j(),u(`li`,{key:e.code},[s(`button`,{class:i([`flex w-full cursor-pointer items-center justify-between rounded-lg border-none bg-transparent px-2.5 py-2 transition-all duration-150 ease-in-out hover:bg-base-content/8`,{"bg-primary/15 hover:bg-primary/20":o(t)===e.code}]),onClick:t=>E(e.code)},[s(`span`,{class:i([`text-[0.8125rem] font-medium text-base-content`,{"text-primary":o(t)===e.code}])},T(e.name),3),o(t)===e.code?(j(),u(`div`,ye,[...n[0]||=[s(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 20 20`,fill:`currentColor`,class:`h-full w-full`},[s(`path`,{"fill-rule":`evenodd`,d:`M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z`,"clip-rule":`evenodd`})],-1)]])):k(``,!0)],10,ve)]))),128))])],4)):k(``,!0)]),_:1})]))]))}}),xe=Object.assign(be,{__name:`LangSwitcher`}),Se={class:`relative`},Ce=e({__name:`ThemeSwitcher`,setup(e){let t=F(),n=P(null),r=P(null),a=P(!1),{floatingStyles:c}=R(n,r,{placement:`top`,middleware:[L(10),ee(),z({padding:8})],whileElementsMounted:B});function f(){a.value=!a.value}function p(e){t.curTheme=e,document.documentElement.setAttribute(`data-theme`,e),a.value=!1}function g(e){let t=e.target;!n.value?.contains(t)&&!r.value?.contains(t)&&(a.value=!1)}return b(()=>{document.addEventListener(`click`,g)}),D(()=>{document.removeEventListener(`click`,g)}),(e,g)=>{let y=Z;return j(),u(`div`,Se,[s(`button`,{ref_key:`reference`,ref:n,class:i([`flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border-none bg-primary text-primary-content transition-all duration-200 ease-in-out hover:scale-110 hover:shadow-[0_4px_12px_oklch(var(--p)/0.4)]`,{"scale-110 rotate-[15deg]":o(a)}]),onClick:v(f,[`stop`])},[h(o(X),{size:18})],2),(j(),d(_,{to:`body`},[h(l,{"enter-active-class":`transition-opacity duration-150`,"leave-active-class":`transition-opacity duration-100`,"enter-from-class":`opacity-0`,"leave-to-class":`opacity-0`},{default:C(()=>[o(a)?(j(),u(`div`,{key:0,ref_key:`floating`,ref:r,style:m(o(c)),class:`z-70 w-44 overflow-hidden rounded-xl shadow-lg`},[g[0]||=s(`div`,{class:`flex items-center border-b border-gray-700 bg-gray-800/90 px-3 py-2`},[s(`span`,{class:`text-[0.6875rem] font-semibold tracking-[0.05em] text-gray-400 uppercase`},` Theme `)],-1),h(y,{"model-value":o(t).curTheme,"onUpdate:modelValue":p},null,8,[`model-value`])],4)):k(``,!0)]),_:1})]))])}}}),we=Object.assign(Ce,{__name:`ThemeSwitcher`}),Te={class:`mx-2 mb-2 overflow-hidden rounded-2xl shadow-lg backdrop-blur-[12px]`,style:{border:`1px solid color-mix(in oklch, var(--color-base-content) 10%, transparent)`,background:`color-mix(in oklch, var(--color-base-300) 90%, transparent)`}},Ee={class:`grid h-16 grid-cols-6`},De={class:`sr-only`},Oe=e({__name:`MobileBottomNav`,props:{navItems:{}},setup(e){let t=p(),n=e=>t.path===e,r=P(!1);b(()=>{a(),window.addEventListener(`resize`,a),requestAnimationFrame(()=>{r.value=!0})}),D(()=>{document.body.style.paddingBottom=`0`,window.removeEventListener(`resize`,a)});function a(){document.body.style.paddingBottom=window.innerWidth<1024?`4.5rem`:`0`}return(t,a)=>{let l=g;return j(),u(`nav`,{"aria-label":`Mobile bottom navigation`,class:i([`fixed inset-x-0 bottom-0 z-50 transition-all duration-500 ease-[cubic-bezier(0.22,1,0.36,1)] lg:hidden`,o(r)?`translate-y-0 opacity-100`:`translate-y-full opacity-0`])},[s(`div`,Te,[s(`div`,Ee,[(j(!0),u(c,null,x(e.navItems,e=>(j(),d(l,{key:e.href,to:e.href,class:i([`group relative flex flex-col items-center justify-center gap-0.5 no-underline transition-all duration-300 ease-in-out active:scale-90`,n(e.href)?`text-primary`:`text-base-content/60 hover:text-base-content`])},{default:C(()=>[s(`div`,{class:i([`absolute inset-1 rounded-xl transition-all duration-300 ease-in-out`,n(e.href)?`bg-primary/10`:`bg-transparent group-hover:bg-base-content/5`])},null,2),s(`div`,{class:i([`absolute top-1 h-1 rounded-full bg-primary transition-all duration-300 ease-in-out`,n(e.href)?`w-8 opacity-100`:`w-0 opacity-0`])},null,2),s(`div`,{class:i([`relative z-10 transition-all duration-300 ease-in-out group-hover:scale-105`,n(e.href)?`scale-110 text-xl`:`scale-100 text-lg`])},[(j(),d(M(e.icon)))],2),s(`span`,De,T(`Navigate to ${e.name}`),1),s(`span`,{"aria-hidden":`true`,class:i([`relative z-10 text-[10px] font-medium transition-all duration-300 ease-in-out group-hover:opacity-100`,n(e.href)?`opacity-100`:`opacity-80`])},T(e.name),3)]),_:2},1032,[`to`,`class`]))),128))])])],2)}}}),ke=Object.assign(Oe,{__name:`MobileBottomNav`}),Ae={class:`drawer-content flex h-full flex-col`},je={class:`z-50 flex h-14 items-center gap-2 border-b border-[var(--sidebar-border)] bg-[color-mix(in_oklch,var(--color-base-300)_95%,transparent)] px-2 shadow-[0_4px_20px_color-mix(in_oklch,var(--color-base-content)_5%,transparent)] backdrop-blur-[12px] sm:px-4 lg:hidden`},Me={key:0,for:`main-drawer`,class:`flex h-9 w-9 cursor-pointer items-center justify-center rounded-lg bg-transparent text-base-content transition-all duration-200 ease-in-out hover:bg-[var(--sidebar-hover)]`,"aria-label":`open sidebar`},Ne={class:`min-w-0 shrink`},Pe={class:`ml-auto flex shrink-0 items-center gap-1`},Fe={class:`flex min-h-0 flex-1 flex-col p-2 sm:p-4`},Ie={key:0,class:`drawer-side z-[60]`},Le={class:`flex shrink-0 flex-col gap-2 border-b border-[var(--sidebar-border)] p-3`},Re={class:`flex-1 overflow-y-auto p-2`},ze={class:`m-0 flex list-none flex-col gap-1 p-0`},Be={class:`flex shrink-0 items-center justify-center transition-transform duration-200 ease-in-out group-hover:scale-110`},Ve={key:0,class:`absolute top-1/2 left-0 h-[60%] w-[3px] -translate-y-1/2 animate-[indicatorIn_0.2s_ease-out] rounded-r-sm bg-primary`},He=e({__name:`Sidebar`,setup(e){let n=p(),{t:r}=N(),a=F(),l=y(()=>[{href:`/overview`,name:r(`overview`),icon:te},{href:`/proxies`,name:r(`proxies`),icon:ie},{href:`/rules`,name:r(`rules`),icon:K},{href:`/connections`,name:r(`connections`),icon:G},{href:`/logs`,name:r(`logs`),icon:q},{href:`/config`,name:r(`config`),icon:ae}]),f=e=>n.path===e,_=P(null);S(()=>n.path,()=>{_.value&&(_.value.checked=!1)});let v=()=>{a.sidebarExpanded=!a.sidebarExpanded};return(e,p)=>{let y=he,b=xe,S=we,w=g,D=Q,A=ke;return j(),u(`div`,{class:i([`drawer h-full [--sidebar-border:color-mix(in_oklch,var(--color-base-content)_10%,transparent)] [--sidebar-hover:color-mix(in_oklch,var(--color-base-content)_5%,transparent)]`,{"lg:drawer-open":o(n).path!==`/setup`}])},[s(`input`,{id:`main-drawer`,ref_key:`drawerCheckbox`,ref:_,type:`checkbox`,class:`drawer-toggle`},null,512),s(`div`,Ae,[s(`header`,je,[o(n).path!==`/setup`&&!o(a).useMobileBottomNav?(j(),u(`label`,Me,[h(o(Y),{class:`h-5 w-5`})])):k(``,!0),s(`div`,Ne,[h(y)]),s(`div`,Pe,[p[0]||=s(`div`,{id:`header-traffic-indicator`,class:`flex items-center`},null,-1),h(b),h(S)])]),s(`div`,Fe,[E(e.$slots,`default`,{},void 0,!0)])]),o(n).path===`/setup`?k(``,!0):(j(),u(`div`,Ie,[p[1]||=s(`label`,{for:`main-drawer`,"aria-label":`close sidebar`,class:`drawer-overlay bg-[color-mix(in_oklch,var(--color-base-content)_40%,transparent)] backdrop-blur-[4px]`},null,-1),s(`div`,{class:i([`flex h-full w-52 flex-col border-r border-[var(--sidebar-border)] bg-[linear-gradient(180deg,color-mix(in_oklch,var(--color-base-200)_98%,transparent)_0%,var(--color-base-200)_100%)] backdrop-blur-[12px] transition-[width] duration-300 ease-[cubic-bezier(0.4,0,0.2,1)]`,o(a).sidebarExpanded?``:`lg:w-16`])},[s(`div`,Le,[s(`div`,{class:i([`flex items-center`,o(a).sidebarExpanded?``:`lg:justify-center`])},[O(h(y,{class:`hidden lg:block`},null,512),[[t,o(a).sidebarExpanded]]),h(y,{class:`block lg:hidden`})],2),s(`button`,{class:i([`hidden w-full cursor-pointer items-center justify-center gap-2 rounded-lg border border-[var(--sidebar-border)] bg-transparent p-2 text-sm text-base-content transition-all duration-200 ease-in-out hover:border-[color-mix(in_oklch,var(--color-base-content)_20%,transparent)] hover:bg-[var(--sidebar-hover)] lg:flex`,o(a).sidebarExpanded?``:`aspect-square w-auto`]),onClick:v},[o(a).sidebarExpanded?(j(),d(o(U),{key:1,class:`h-5 w-5`})):(j(),d(o(V),{key:0,class:`h-5 w-5`})),s(`span`,{class:i(o(a).sidebarExpanded?``:`lg:hidden`)},T(o(r)(`collapse`)),3)],2)]),s(`nav`,Re,[s(`ul`,ze,[(j(!0),u(c,null,x(o(l),(e,t)=>(j(),u(`li`,{key:e.href,class:`animate-[slideIn_0.3s_ease-out_backwards]`,style:m({animationDelay:`${t*50}ms`})},[h(w,{to:e.href,class:i([`relative flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm font-medium text-[color-mix(in_oklch,var(--color-base-content)_70%,transparent)] no-underline transition-all duration-200 ease-in-out hover:bg-[var(--sidebar-hover)] hover:text-base-content`,[f(e.href)?`bg-[color-mix(in_oklch,var(--color-primary)_15%,transparent)] !text-primary hover:bg-[color-mix(in_oklch,var(--color-primary)_20%,transparent)]`:``,o(a).sidebarExpanded?``:`lg:justify-center lg:px-0`]]),title:o(a).sidebarExpanded?void 0:e.name},{default:C(()=>[s(`div`,Be,[(j(),d(M(e.icon),{class:`h-5 w-5`}))]),s(`span`,{class:i([`flex-1 overflow-hidden text-ellipsis whitespace-nowrap`,o(a).sidebarExpanded?``:`lg:hidden`])},T(e.name),3),f(e.href)?(j(),u(`div`,Ve)):k(``,!0)]),_:2},1032,[`to`,`class`,`title`])],4))),128))])]),s(`div`,{class:i([`shrink-0 border-t border-[var(--sidebar-border)] p-2`,o(a).sidebarExpanded?``:`lg:flex lg:flex-col lg:items-center`])},[s(`div`,{id:`sidebar-traffic-expanded`,class:i([`mb-2 hidden w-full`,o(a).sidebarExpanded?`lg:block`:``])},null,2),s(`div`,{id:`sidebar-traffic-indicator`,class:i([`mb-2 hidden w-full lg:block`,o(a).sidebarExpanded?`lg:!hidden`:``])},null,2),s(`div`,{class:i([`mb-2 hidden items-center gap-1 lg:flex`,o(a).sidebarExpanded?`flex-row`:`flex-col`])},[h(b),h(S)],2),h(D,{collapsed:!o(a).sidebarExpanded},null,8,[`collapsed`])],2)],2)])),o(a).useMobileBottomNav&&o(n).path!==`/setup`?(j(),d(A,{key:1,"nav-items":o(l)},null,8,[`nav-items`])):k(``,!0)],2)}}}),Ue=Object.assign($(He,[[`__scopeId`,`data-v-f7d701f6`]]),{__name:`Sidebar`});const We=globalThis.setInterval;function Ge(){let e=n(),t=ce(),r=I(),i=ue(),a=F(),o=null,s=null,c=null,l=null,u=null,d=(t,n)=>{let r=e.currentEndpoint;if(!r)return null;let i=e.wsEndpointURL,a=r.secret,o=new URLSearchParams;a&&o.set(`token`,a);let s=new WebSocket(`${i}/${t}?${o.toString()}`);return s.onmessage=e=>{try{n(JSON.parse(e.data))}catch{}},s.onerror=e=>{console.error(`WebSocket error for ${t}:`,e)},s};return{connect:()=>{if(oe()){let e=se();t.updateFromWsMsg({connections:e.mockConnections,uploadTotal:e.mockTrafficStats.up,downloadTotal:e.mockTrafficStats.down}),r.setLatestTraffic(e.mockTrafficStats),r.setLatestMemory(e.mockMemory);let n=Date.now(),a=e.mockConnections.length;for(let t=30;t>=0;t--){let i=n-t*1e3,o=e.mockTrafficStats.down+Math.floor(Math.random()*1e5)-5e4,s=e.mockTrafficStats.up+Math.floor(Math.random()*2e4)-1e4,c=e.mockMemory.inuse+Math.floor(Math.random()*5e6)-25e5,l=a+Math.floor(Math.random()*10)-5;r.addTrafficDataPoint(i,o,s),r.addMemoryDataPoint(i,c),r.addConnectionCountDataPoint(i,l)}e.mockLogs.forEach(e=>{i.addLog(e)}),u=We(()=>{let t=Date.now(),n={up:e.mockTrafficStats.up+Math.floor(Math.random()*1e4),down:e.mockTrafficStats.down+Math.floor(Math.random()*5e4)};r.setLatestTraffic(n),r.addTrafficDataPoint(t,n.down,n.up);let i={inuse:e.mockMemory.inuse+Math.floor(Math.random()*5e6)-25e5,oslimit:e.mockMemory.oslimit};r.setLatestMemory(i),r.addMemoryDataPoint(t,i.inuse);let a=e.mockConnections.length+Math.floor(Math.random()*10)-5;r.addConnectionCountDataPoint(t,a)},1e3);return}o=d(`connections`,e=>{let n=e;if(t.updateFromWsMsg(n),n){let e=n.connections?.length??0;r.addConnectionCountDataPoint(Date.now(),e)}}),s=d(`traffic`,e=>{let t=e;r.setLatestTraffic(t),r.addTrafficDataPoint(Date.now(),t.down,t.up)}),c=d(`memory`,e=>{let t=e;r.setLatestMemory(t),r.addMemoryDataPoint(Date.now(),t.inuse)});let n=e.currentEndpoint;if(n){let t=e.wsEndpointURL,r=new URLSearchParams;n.secret&&r.set(`token`,n.secret),r.set(`level`,a.logLevel),l=new WebSocket(`${t}/logs?${r.toString()}`),l.onmessage=e=>{try{let t=JSON.parse(e.data);i.addLog(t)}catch{}}}},disconnect:()=>{u&&=(clearInterval(u),null),o?.close(),s?.close(),c?.close(),l?.close(),o=null,s=null,c=null,l=null},reconnectLogs:()=>{l?.close();let t=e.currentEndpoint;if(t){let n=e.wsEndpointURL,r=new URLSearchParams;t.secret&&r.set(`token`,t.secret),r.set(`level`,a.logLevel),l=new WebSocket(`${n}/logs?${r.toString()}`),l.onmessage=e=>{try{let t=JSON.parse(e.data);i.addLog(t)}catch{}}}}}}var Ke={class:`hidden`},qe=e({__name:`ProtectedResources`,setup(e){let{connect:t,disconnect:n,reconnectLogs:r}=Ge(),i=F();return b(()=>{t()}),D(()=>{n()}),S(()=>i.logLevel,()=>{r()}),(e,t)=>(j(),u(`div`,Ke))}}),Je=Object.assign(qe,{__name:`ProtectedResources`}),Ye=f(de(),1),Xe={class:`flex items-center gap-1`},Ze={class:`font-mono text-xs`},Qe={class:`flex items-center gap-1`},$e={class:`font-mono text-xs`},et={class:`flex items-center justify-center gap-1`},tt={class:`font-mono text-xs`},nt={class:`flex items-center justify-center gap-1`},rt={class:`font-mono text-xs`},it={key:0,class:`w-full rounded-lg bg-[color-mix(in_oklch,var(--color-base-100)_50%,transparent)] p-2`},at={class:`grid grid-cols-2 gap-1 text-xs`},ot={class:`flex items-center gap-1`},st={class:`truncate font-mono text-xs`},ct={class:`flex items-center gap-1`},lt={class:`truncate font-mono text-xs`},ut={class:`flex items-center gap-1`},dt={class:`font-mono text-xs`},ft={class:`flex items-center gap-1`},pt={class:`font-mono text-xs`},mt=[`title`],ht={class:`flex flex-col gap-2 p-3`},gt={class:`flex items-center justify-between gap-2`},_t={class:`text-xs font-semibold uppercase opacity-60`},vt={class:`flex items-center gap-1`},yt=[`title`],bt=[`title`],xt={class:`grid grid-cols-2 gap-x-4 gap-y-1 text-xs`},St={class:`flex items-center gap-1`},Ct={class:`font-mono text-xs font-medium`},wt={class:`flex items-center gap-1`},Tt={class:`font-mono text-xs font-medium`},Et={class:`flex items-center gap-1 opacity-70`},Dt={class:`font-mono text-xs`},Ot={class:`flex items-center gap-1 opacity-70`},kt={class:`font-mono text-xs`},At=e({__name:`GlobalTrafficIndicator`,setup(e){let t=I(),n=ce(),r=F(),f=a(`globalTrafficIndicatorVisible`,!0),p=a(`globalTrafficIndicatorCollapsed`,!0),g=a(`globalTrafficIndicatorPosition`,{x:-1,y:-1}),v=P(!1),x=P({x:0,y:0}),E=P(null),D=P(null),O,M=y(()=>t.latestTraffic?.down??0),N=y(()=>t.latestTraffic?.up??0),L=y(()=>t.latestMemory?.inuse??0),ee=y(()=>n.latestConnectionMsg?.connections?.length??0),R=e=>le(e).toString(),z=y(()=>g.value.x===-1||g.value.y===-1?{right:`16px`,bottom:`16px`}:{left:`${g.value.x}px`,top:`${g.value.y}px`});function B(){f.value=!f.value}function te(){p.value=!p.value}function V(){p.value=!1,g.value={x:-1,y:-1}}function U(e){if(!E.value)return;v.value=!0;let t=E.value.getBoundingClientRect(),n=`touches`in e?e.touches[0].clientX:e.clientX,r=`touches`in e?e.touches[0].clientY:e.clientY;x.value={x:n-t.left,y:r-t.top},g.value.x===-1&&(g.value.x=t.left,g.value.y=t.top),document.addEventListener(`mousemove`,G),document.addEventListener(`mouseup`,K),document.addEventListener(`touchmove`,G),document.addEventListener(`touchend`,K)}function G(e){if(!v.value)return;let t=`touches`in e?e.touches[0].clientX:e.clientX,n=`touches`in e?e.touches[0].clientY:e.clientY,r=t-x.value.x,i=n-x.value.y,a=E.value?.getBoundingClientRect(),o=a?.width||200,s=a?.height||150;r=Math.max(0,Math.min(window.innerWidth-o,r)),i=Math.max(0,Math.min(window.innerHeight-s,i)),g.value.x=r,g.value.y=i}function K(){v.value&&(v.value=!1,document.removeEventListener(`mousemove`,G),document.removeEventListener(`mouseup`,K),document.removeEventListener(`touchmove`,G),document.removeEventListener(`touchend`,K))}function q(){if(!D.value)return;O&&=(O.destroy(),void 0);let e=fe(),n=D.value.offsetWidth||200;O=Ye.default.chart(D.value,{chart:{type:`areaspline`,backgroundColor:`transparent`,spacing:[0,0,0,0],margin:[0,0,0,0],animation:!1,width:n,height:48},credits:{enabled:!1},accessibility:{enabled:!1},title:{text:void 0},legend:{enabled:!1},xAxis:{visible:!1,type:`datetime`},yAxis:{visible:!1,min:0},tooltip:{enabled:!1},plotOptions:{areaspline:{lineWidth:1.5,marker:{enabled:!1},fillOpacity:.2,animation:!1}},series:[{type:`areaspline`,name:`Download`,color:e.seriesColors[1],data:t.trafficChartHistory.download.length>0?[...t.trafficChartHistory.download].slice(-30):[[Date.now(),0]]},{type:`areaspline`,name:`Upload`,color:e.seriesColors[0],data:t.trafficChartHistory.upload.length>0?[...t.trafficChartHistory.upload].slice(-30):[[Date.now(),0]]}]})}function ie(){if(!O)return;let e=[...t.trafficChartHistory.download].slice(-30),n=[...t.trafficChartHistory.upload].slice(-30);O.series[0]?.setData(e,!1),O.series[1]?.setData(n,!0)}function ae(){if(!$)return;let e=[...t.trafficChartHistory.download].slice(-30),n=[...t.trafficChartHistory.upload].slice(-30);$.series[0]?.setData(e,!1),$.series[1]?.setData(n,!0)}function J(){if(!Q.value)return;$&&=($.destroy(),void 0);let e=fe();$=Ye.default.chart(Q.value,{chart:{type:`areaspline`,backgroundColor:`transparent`,spacing:[0,0,0,0],margin:[0,0,0,0],animation:!1,height:40},credits:{enabled:!1},accessibility:{enabled:!1},title:{text:void 0},legend:{enabled:!1},xAxis:{visible:!1,type:`datetime`},yAxis:{visible:!1,min:0},tooltip:{enabled:!1},plotOptions:{areaspline:{lineWidth:1.5,marker:{enabled:!1},fillOpacity:.2,animation:!1}},series:[{type:`areaspline`,name:`Download`,color:e.seriesColors[1],data:t.trafficChartHistory.download.length>0?[...t.trafficChartHistory.download].slice(-30):[[Date.now(),0]]},{type:`areaspline`,name:`Upload`,color:e.seriesColors[0],data:t.trafficChartHistory.upload.length>0?[...t.trafficChartHistory.upload].slice(-30):[[Date.now(),0]]}]})}S(()=>t.latestTraffic,e=>{e&&(O?ie():D.value&&f.value&&!p.value&&q(),$?ae():Q.value&&J())}),S(()=>r.curTheme,()=>{D.value&&!p.value&&f.value&&q(),Q.value&&J()}),S(p,e=>{!e&&f.value?A(()=>{setTimeout(()=>{D.value&&t.latestTraffic&&q()},50)}):e&&O&&(O.destroy(),O=void 0)}),S(f,e=>{e&&!p.value?A(()=>{setTimeout(()=>{D.value&&t.latestTraffic&&q()},50)}):!e&&O&&(O.destroy(),O=void 0)}),S(()=>r.sidebarExpanded,e=>{e&&A(()=>{setTimeout(()=>{Q.value&&t.latestTraffic&&J()},100)})});let Y=P(!1),X=P(!1),Z=P(!1),Q=P(null),$;return b(()=>{A(()=>{Y.value=!!document.getElementById(`header-traffic-indicator`),X.value=!!document.getElementById(`sidebar-traffic-indicator`),Z.value=!!document.getElementById(`sidebar-traffic-expanded`)}),f.value&&!p.value&&t.latestTraffic&&setTimeout(()=>{D.value&&q()},100),t.latestTraffic&&setTimeout(()=>{Q.value&&J()},150)}),w(()=>{O&&=(O.destroy(),void 0),$&&=($.destroy(),void 0)}),(e,n)=>(j(),u(c,null,[o(Y)?(j(),d(_,{key:0,to:`#header-traffic-indicator`},[o(f)&&o(p)&&o(t).latestTraffic?(j(),u(`div`,{key:0,class:`flex cursor-pointer items-center gap-2 rounded-lg bg-[color-mix(in_oklch,var(--color-base-100)_50%,transparent)] px-2 py-1 transition-[background] duration-200 ease-in-out hover:bg-[var(--color-base-100)]`,onClick:V},[s(`div`,Xe,[h(o(H),{class:`size-3 shrink-0 text-[var(--color-success)]`}),s(`span`,Ze,T(R(o(M)))+`/s`,1)]),n[0]||=s(`div`,{class:`h-3 w-px bg-[color-mix(in_oklch,var(--color-base-content)_20%,transparent)]`},null,-1),s(`div`,Qe,[h(o(W),{class:`size-3 shrink-0 text-[var(--color-info)]`}),s(`span`,$e,T(R(o(N)))+`/s`,1)])])):k(``,!0)])):k(``,!0),o(X)?(j(),d(_,{key:1,to:`#sidebar-traffic-indicator`},[o(t).latestTraffic?(j(),u(`div`,{key:0,class:`w-full cursor-pointer rounded-lg bg-[color-mix(in_oklch,var(--color-base-100)_50%,transparent)] p-2 transition-[background] duration-200 ease-in-out hover:bg-[var(--color-base-100)]`,onClick:V},[s(`div`,et,[h(o(H),{class:`size-3 shrink-0 text-[var(--color-success)]`}),s(`span`,tt,T(R(o(M)))+`/s`,1)]),s(`div`,nt,[h(o(W),{class:`size-3 shrink-0 text-[var(--color-info)]`}),s(`span`,rt,T(R(o(N)))+`/s`,1)])])):k(``,!0)])):k(``,!0),o(Z)?(j(),d(_,{key:2,to:`#sidebar-traffic-expanded`},[o(t).latestTraffic?(j(),u(`div`,it,[s(`div`,{ref_key:`sidebarChartContainer`,ref:Q,class:`mb-2 h-10 w-full`},null,512),s(`div`,at,[s(`div`,ot,[h(o(H),{class:`size-3 shrink-0 text-[var(--color-success)]`}),s(`span`,st,T(R(o(M)))+`/s`,1)]),s(`div`,ct,[h(o(W),{class:`size-3 shrink-0 text-[var(--color-info)]`}),s(`span`,lt,T(R(o(N)))+`/s`,1)])])])):k(``,!0)])):k(``,!0),o(f)&&o(p)&&o(t).latestTraffic&&!o(Y)&&!o(X)?(j(),u(`div`,{key:3,class:`fixed right-4 bottom-4 z-50 flex cursor-pointer items-center gap-2 rounded-xl bg-[var(--color-base-200)] px-3 py-2 shadow-lg`,onClick:V},[s(`div`,ut,[h(o(H),{class:`size-3 shrink-0 text-[var(--color-success)]`}),s(`span`,dt,T(R(o(M)))+`/s`,1)]),n[1]||=s(`div`,{class:`h-3 w-px bg-[color-mix(in_oklch,var(--color-base-content)_20%,transparent)]`},null,-1),s(`div`,ft,[h(o(W),{class:`size-3 shrink-0 text-[var(--color-info)]`}),s(`span`,pt,T(R(o(N)))+`/s`,1)])])):k(``,!0),o(f)?k(``,!0):(j(),u(`button`,{key:4,class:`fixed right-4 bottom-4 z-50 flex size-8 cursor-pointer items-center justify-center rounded-full border-none bg-[var(--color-primary)] text-[var(--color-primary-content)] shadow-lg transition-all duration-200 ease-in-out hover:scale-110`,title:e.$t(`showTrafficIndicator`),onClick:B},[h(o(W),{class:`size-4`})],8,mt)),h(l,{name:`traffic-expand`},{default:C(()=>[o(f)&&!o(p)&&o(t).latestTraffic?(j(),u(`div`,{key:0,ref_key:`containerRef`,ref:E,class:i([`fixed z-50 min-w-56 rounded-xl bg-[var(--color-base-200)] shadow-lg select-none`,{"cursor-grabbing":o(v)}]),style:m(o(z))},[s(`div`,ht,[s(`div`,gt,[s(`div`,{class:`flex cursor-grab items-center gap-1 active:cursor-grabbing`,onMousedown:U,onTouchstart:U},[h(o(ne),{class:`size-4 opacity-40`}),s(`span`,_t,T(e.$t(`traffic`)),1)],32),s(`div`,vt,[s(`button`,{class:`flex size-6 cursor-pointer items-center justify-center rounded-full border-none bg-transparent text-[var(--color-base-content)] transition-[background] duration-200 ease-in-out hover:bg-[color-mix(in_oklch,var(--color-base-content)_10%,transparent)]`,title:e.$t(`hideTrafficIndicator`),onClick:te},[...n[2]||=[s(`span`,{class:`text-xs`},`âˆ’`,-1)]],8,yt),s(`button`,{class:`flex size-6 cursor-pointer items-center justify-center rounded-full border-none bg-transparent text-[var(--color-base-content)] transition-[background] duration-200 ease-in-out hover:bg-[color-mix(in_oklch,var(--color-base-content)_10%,transparent)]`,title:e.$t(`hideTrafficIndicator`),onClick:B},[h(o(re),{class:`size-3`})],8,bt)])]),s(`div`,{ref_key:`chartContainer`,ref:D,class:`h-12 w-full`},null,512),s(`div`,xt,[s(`div`,St,[h(o(H),{class:`size-3 shrink-0 text-[var(--color-success)]`}),s(`span`,Ct,T(R(o(M)))+`/s `,1)]),s(`div`,wt,[h(o(W),{class:`size-3 shrink-0 text-[var(--color-info)]`}),s(`span`,Tt,T(R(o(N)))+`/s `,1)]),s(`div`,Et,[s(`span`,null,T(e.$t(`memory`))+`:`,1),s(`span`,Dt,T(R(o(L))),1)]),s(`div`,Ot,[s(`span`,null,T(e.$t(`connections`))+`:`,1),s(`span`,kt,T(o(ee)),1)])])])],6)):k(``,!0)]),_:1})],64))}}),jt=Object.assign($(At,[[`__scopeId`,`data-v-63337a16`]]),{__name:`GlobalTrafficIndicator`}),Mt=[`data-theme`],Nt=e({__name:`default`,setup(e){let t=F(),a=n(),s=I(),c=P(null);S(c,e=>{e&&(s.rootElement=e)}),S([()=>t.autoSwitchTheme,r()],([e,n])=>{e&&(t.curTheme=n?t.favNightTheme:t.favDayTheme)},{immediate:!0}),S(()=>t.curTheme,e=>{document.documentElement.setAttribute(`data-theme`,e)},{immediate:!0});let l=y(()=>oe()||!!a.currentEndpoint);return(e,n)=>{let r=Ue,a=Je,s=jt;return j(),u(`div`,{ref_key:`rootElement`,ref:c,class:i([`relative h-screen overscroll-y-none bg-base-100 antialiased`,o(t).enableTwemoji?`font-twemoji`:`font-default`]),"data-theme":o(t).curTheme},[h(r,null,{default:C(()=>[E(e.$slots,`default`)]),_:3}),o(l)?(j(),d(a,{key:0})):k(``,!0),o(l)?(j(),d(s,{key:1})):k(``,!0)],10,Mt)}}});export{Nt as default};